# yaml-language-server: https://www.schemastore.org/prometheus-alertmanager.json
groups:
  - name: smartcitizen_device_alerts
    rules:
      - alert: SmartCitizenDeviceLowBattery
        expr: |-
          smartcitizen_sensor_device_battery < 20
            and smartcitizen_sensor_device_battery > 10
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: "Device {{ $labels.device }} has low battery"
          description: |-
            The battery level of device {{ $labels.device }} is at {{ $value }}%.
            Please recharge or replace the battery soon to ensure continued operation.
      - alert: SmartCitizenDeviceCriticalBattery
        expr: smartcitizen_sensor_device_battery <= 10
        for: 5m
        labels:
          severity: critical
          notify: team_on_call
        annotations:
          summary: "Device {{ $labels.device }} has critical battery level"
          description: |-
            The battery level of device {{ $labels.device }} is at {{ $value }}%.
            Immediate action is required to recharge or replace the battery to prevent device shutdown.
